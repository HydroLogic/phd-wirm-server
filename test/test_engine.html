<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Test Engine</title>
  
</head>
<body>
  <script src="numeric-1.2.6.js"></script>
  <script src="d3-3.0.8.js"></script>
  <script src="engine.js"></script>
  <script>
  var engine = App.SimulationEngine;
  var parameters = {
    L_0: 10,
    o_0: 8,
    H: 5,
    T: 20,
    U: 0.5,
    k_d_20: 0.5,
    k_so: 1,
    theta_BOD: 1.047,
    theta_DO: 1.024,
    x_max: 1000
  };
  var soln = engine(parameters);

  var header = ["distance_km", "bod_ppm", "do_ppm"];
  var csvContent = "data:text/csv;charset=utf-8,";

  csvContent += header.join(",") + "\n";

  var n = soln[0].data.length
  var x_km, bod_ppm, do_ppm;
  var data = [];
  for (var i = 0; i < n; i++) {
    x_km = soln[0].data[i][0];
    bod_ppm = soln[0].data[i][1];
    do_ppm = soln[1].data[i][1];
    data.push([x_km, bod_ppm, do_ppm]);
  }

  data.forEach(function(row, index){
    dataString = row.join(",");
    csvContent += index < data.length ? dataString+ "\n" : dataString;
  });

  var encodedUri = encodeURI(csvContent); 
  var link = document.createElement("a");
  link.setAttribute("href", encodedUri);
  link.setAttribute("download", "solution.csv");
  link.click();
  </script>
</body>
</html>